L.BoatIcon=L.Icon.extend({options:{iconSize:new L.Point(150,150),className:"leaflet-boat-icon",course:0,color:"#8ED6FF",labelAnchor:[23,0],wind:false,windDirection:0,windSpeed:0},x:66,y:85,x_fac:.18,y_fac:.18,ctx:null,lastHeading:0,lastWindDirection:0,createIcon:function(){var e=document.createElement("canvas");this._setIconStyles(e,"icon");var t=this.options.iconSize;e.width=t.x;e.height=t.y;this.ctx=e.getContext("2d");this.draw(e.getContext("2d"),t.x,t.y);return e},createShadow:function(){return null},draw:function(e,t,n){if(!e)return;var r=this.x;var i=this.y;var s=this.x_fac;var o=this.y_fac;e.clearRect(0,0,t,n);e.translate(t/2,n/2);e.rotate(this.options.course*Math.PI/180);e.translate(-t/2,-n/2);e.beginPath();e.moveTo(r,i);e.bezierCurveTo(r,i+80*o,r+100*s,i+80*o,r+100*s,i);e.quadraticCurveTo(r+100*s,i-100*o,r+50*s,i-200*o);e.quadraticCurveTo(r,i-100*o,r,i);e.fillStyle=this.options.color;e.fill();e.stroke();e.closePath();if(this.options.wind==true){e.translate(t/2,n/2);e.rotate(this.options.windDirection*Math.PI/180);e.translate(-t/2,-n/2);e.beginPath();e.moveTo(t/2,i-45);e.lineTo(t/2,i-70);var u=t/2;var a=5*Math.round(this.options.windSpeed/5);var f=Math.floor(a/10);var l=a%10>0;var c=70;for(var h=0;h<f;h++){e.moveTo(u,i-c);e.lineTo(u+8,i-c-8);c-=5}if(l){if(f==0)c-=5;e.moveTo(u,i-c);e.lineTo(u+5,i-c-5)}e.stroke()}},set:function(e,t,n){this.options.wind=true;this.options.course=e%360-this.lastHeading;this.lastHeading=e%360;this.options.windDirection=n%360-e%360;this.lastHeading+=this.options.windDirection;this.options.windSpeed=t;var r=this.options.iconSize;this.draw(this.ctx,r.x,r.y)},setHeading:function(e){this.options.course=e%360-this.lastHeading;this.lastHeading=e%360;var t=this.options.iconSize;this.draw(this.ctx,t.x,t.y)}});L.BoatMarker=L.Marker.extend({set:function(e,t,n){this.options.icon.set(e,t,n)},setHeading:function(e){this.options.icon.setHeading(e)}});L.boatMarker=function(e,t){var n="color"in t?t.color:"#f1c40f";t.icon=new L.BoatIcon({color:n});return new L.BoatMarker(e,t)}